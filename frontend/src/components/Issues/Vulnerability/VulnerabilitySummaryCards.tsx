import { Box, Card, CardContent, Typography, Chip } from "@mui/material";
import { VulnerabilitySummary } from "../../../types/vulnerability.types";

interface VulnerabilitySummaryCardsProps {
  summary: VulnerabilitySummary;
}

export const VulnerabilitySummaryCards = ({
  summary,
}: VulnerabilitySummaryCardsProps) => {
  const {
    total,
    critical: criticalCount,
    high: highCount,
    medium: mediumCount,
    low: lowCount,
    fixed: fixedCount,
    notFixed: notFixedCount,
    inProgress: inProgressCount,
    mostAffectedAsset,
  } = summary;

  return (
    <Box
      sx={{
        display: "grid",
        gridTemplateColumns: {
          xs: "1fr",
          md: "1fr 1fr",
          lg: "1fr 1fr 1fr 1fr",
        },
        gap: 3,
        mb: 4,
      }}
    >
      <Card>
        <CardContent>
          <Typography variant="subtitle2" color="text.secondary" gutterBottom>
            Total Vulnerabilities
          </Typography>
          <Typography variant="h4">{total}</Typography>
          <Box display="flex" mt={2}>
            <Chip
              label={`Critical: ${criticalCount}`}
              color="error"
              size="small"
              sx={{ mr: 1 }}
            />
            <Chip label={`High: ${highCount}`} color="warning" size="small" />
          </Box>
        </CardContent>
      </Card>
      <Card>
        <CardContent>
          <Typography variant="subtitle2" color="text.secondary" gutterBottom>
            Status
          </Typography>
          <Box display="flex" justifyContent="space-between">
            <Box>
              <Typography variant="h4">{fixedCount}</Typography>
              <Typography variant="body2" color="success.main">
                Fixed
              </Typography>
            </Box>
            <Box>
              <Typography variant="h4" textAlign="right">
                {notFixedCount}
              </Typography>
              <Typography variant="body2" color="error.main" textAlign="right">
                Not Fixed
              </Typography>
            </Box>
          </Box>
          <Box mt={1}>
            <Typography variant="body2" color="text.secondary">
              {inProgressCount} in progress
            </Typography>
          </Box>
        </CardContent>
      </Card>
      <Card>
        <CardContent>
          <Typography variant="subtitle2" color="text.secondary" gutterBottom>
            Medium & Low Severity
          </Typography>
          <Typography variant="h4">{mediumCount + lowCount}</Typography>
          <Box display="flex" mt={2}>
            <Chip
              label={`Medium: ${mediumCount}`}
              color="info"
              size="small"
              sx={{ mr: 1 }}
            />
            <Chip label={`Low: ${lowCount}`} color="success" size="small" />
          </Box>
        </CardContent>
      </Card>
      <Card>
        <CardContent>
          <Typography variant="subtitle2" color="text.secondary" gutterBottom>
            Most Affected Asset
          </Typography>
          <Typography variant="h5" noWrap>
            {mostAffectedAsset.name}
          </Typography>
          <Typography variant="body2" color="text.secondary" mt={2}>
            {mostAffectedAsset.count} vulnerabilities detected
          </Typography>
        </CardContent>
      </Card>
    </Box>
  );
};

export default VulnerabilitySummaryCards;
